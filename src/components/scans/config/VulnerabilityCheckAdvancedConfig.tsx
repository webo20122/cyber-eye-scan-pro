
import { Label } from "@/components/ui/label";
import { Input } from "@/components/ui/input";
import { Checkbox } from "@/components/ui/checkbox";
import { Shield } from "lucide-react";

interface VulnerabilityCheckAdvancedConfigProps {
  vulnParams: {
    target_software_name?: string;
    target_cve_id?: string;
    enable_vulners_lookup?: boolean;
    enable_nvd_lookup?: boolean;
    enable_vendor_advisories?: boolean;
    enable_nessus_integration?: boolean;
    enable_qualys_integration?: boolean;
  };
  setVulnParams: (params: any) => void;
}

export const VulnerabilityCheckAdvancedConfig = ({ vulnParams, setVulnParams }: VulnerabilityCheckAdvancedConfigProps) => {
  return (
    <div className="space-y-4 p-4 border rounded-lg bg-red-50">
      <h4 className="font-medium mb-3 flex items-center gap-2">
        <Shield className="h-4 w-4 text-red-600" />
        Vulnerability Check Configuration
      </h4>
      
      <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
        <div>
          <Label htmlFor="softwareName">Target Software Name/Banner</Label>
          <Input
            id="softwareName"
            value={vulnParams.target_software_name || ""}
            onChange={(e) => setVulnParams({ ...vulnParams, target_software_name: e.target.value })}
            placeholder="nginx 1.18.0"
          />
        </div>
        <div>
          <Label htmlFor="cveId">Specific CVE ID</Label>
          <Input
            id="cveId"
            value={vulnParams.target_cve_id || ""}
            onChange={(e) => setVulnParams({ ...vulnParams, target_cve_id: e.target.value })}
            placeholder="CVE-2023-12345"
          />
        </div>
      </div>

      <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
        <div className="flex items-center space-x-2">
          <Checkbox
            id="vulnersLookup"
            checked={vulnParams.enable_vulners_lookup || false}
            onCheckedChange={(checked) =>
              setVulnParams({ ...vulnParams, enable_vulners_lookup: !!checked })
            }
          />
          <Label htmlFor="vulnersLookup">Enable Vulners Lookup</Label>
        </div>
        
        <div className="flex items-center space-x-2">
          <Checkbox
            id="nvdLookup"
            checked={vulnParams.enable_nvd_lookup || false}
            onCheckedChange={(checked) =>
              setVulnParams({ ...vulnParams, enable_nvd_lookup: !!checked })
            }
          />
          <Label htmlFor="nvdLookup">Enable NVD Lookup</Label>
        </div>
        
        <div className="flex items-center space-x-2">
          <Checkbox
            id="vendorAdvisories"
            checked={vulnParams.enable_vendor_advisories || false}
            onCheckedChange={(checked) =>
              setVulnParams({ ...vulnParams, enable_vendor_advisories: !!checked })
            }
          />
          <Label htmlFor="vendorAdvisories">Enable Vendor Advisories</Label>
        </div>
        
        <div className="flex items-center space-x-2">
          <Checkbox
            id="nessusIntegration"
            checked={vulnParams.enable_nessus_integration || false}
            onCheckedChange={(checked) =>
              setVulnParams({ ...vulnParams, enable_nessus_integration: !!checked })
            }
          />
          <Label htmlFor="nessusIntegration">Enable Nessus Integration</Label>
        </div>
        
        <div className="flex items-center space-x-2">
          <Checkbox
            id="qualysIntegration"
            checked={vulnParams.enable_qualys_integration || false}
            onCheckedChange={(checked) =>
              setVulnParams({ ...vulnParams, enable_qualys_integration: !!checked })
            }
          />
          <Label htmlFor="qualysIntegration">Enable Qualys Integration</Label>
        </div>
      </div>
    </div>
  );
};
